---
title: "TISC CTF 2021"
date: 2021-11-15 00:00:00+0800
excerpt: "The InfoSecurity Challenge (TISC), by Centre for Strategic Infocomm Technologies (CSIT)"
comments: false
---

## Introduction

29 Oct 2021 (2100H) - 14 Nov 2021 (2100H)

TISC is an online challenge organised by CSIT since 2020. It provides opportunities for interested Singaporeans to put their cybersecurity and programming skills to the test by solving challenging puzzles against the clock. There are 10 levels of challenges. Participants who complete 8 levels of challenges and above stand a chance to win cash prizes up to $30,000. Top 30 participants will also be awarded with a mischievously modified Arduino board that can be defused...?! How cool is that!

Level 1 consisted of 12 challenges, 9 of which required me to download the .ova image provided. These challenges revolve around finding hidden files, local drives, browsing history, network logs, etc. The other 3 required basic steganography skills; analysing the metadata of images and audio wave analysis. I will be skipping the write ups for these as they were pretty straightforward.

## Level 2 - Dee Na Saw as a need (Network Forensics)

### Description

We have detected and captured a stream of anomalous DNS network traffic sent out from one of the PALINDROME compromised servers. None of the domain names found are active. Either PALINDROME had shut them down or there's more to it than it seems. This level contains 2 flags and both flags can be found independently from the same pcap file.

Flag 1 will be in this format, TISC{16 characters}.

Flag 2 will be in this format, TISC{17 characters}.

### Solution

Unlike many Wireshark challenges I have done, I noticed that this pcap file was filled with only DNS queries. The queries themselves also look very similar to one another. The first thing that caught my attention was the subdomain names, all of which are prepended with "d33d" followed by what seems to be random characters. I thought this was likely aligned with DNS exfiltration techniques. Looking up the web, I found that hidden data is often in these domain names, encoded in base64.

![traffic.pcap](/images/tisc-2-1.png){: width="700" }

```python
# I used the following command to extract all the domain names:
tshark -r traffic.pcap -T fields -e dns.qry.name > names.txt
```

After trimming off the front portion "d33d" of every entry, I threw the results into [Cyberchef](https://gchq.github.io/CyberChef/) and attempted to decode it in base64 but did not get any interesting results. Further research revealed that they are sometimes also encoded in base32. After I attempted to do so, I spotted possible leads as the first line contained all the English alphabets. I exported this into a file, passed it through strings and grepped for "TISC". Great! I managed to find a part of the flag and this the rest is likely scattered somewhere in the decoded data. With some time and smart guessing, I managed to piece together 3 separate parts of the flag.

This was the part which I was stuck on for days, simply because I have no clue where could they hide the other flag. I started to experimemt with other possible solutions such as hex-decoding the Transaction IDs and checksums but to no avail. I also noticed that each packet has a stream index, so I ordered them by stream index and tried the former solution again. Further, I did a secondary filter on the timestamps. I also noticed that there were some packets with the same UDP port numbers, and I decided to group these packets together to see if I could form any distinct patterns but nope! When I sorted the packets by size, I got really suspicious of particularly 2 packets that have lengths of 88 while the rest of the 10,000+ packets have lengths of 166. As much as I wanted to find the hidden flag in these 2 packets, I had completely no idea what to make out of them.

I eventually figured out that base32 becomes extremely jumbled up with just 1 character added/removed from the encoded data. Because of this, I knew that the initial solution was not intended and that the flag was not supposed to be broken into parts. A clean decode was eventually obtained after I removed 2 characters of every entry after "d33d". That gave me a hint as to what those 2 characters might be used for. Sorting them in order, I realized that they ranged exactly between 01 to 64. Of course, base64 mapping table was the idea! After mapping every number to ASCII, I passed it into Cyberchef once again and decoded it in base64, only to obtain what seemed to look like... a Word Document?! I exported this file and it looked empty initially, but it was just a string that was in white! The string wrote "What you seek is within". Using binwalk, it turns out that the file was both a .docx and an Archive at the same time. I unzipped the file I obtained many other directories and .xml files. By recursively grepping, I finally managed to locate the other flag!

![sus.docx](/images/tisc-2-2.png){: width="700" }
![sus.docx](/images/tisc-2-3.png){: width="700" }

Flag 1: `TISC{1iv3_n0t_0n_3vi1}`

Flag 2: `TISC{n3vEr_0dd_0r_Ev3n}`

## Conclusion

Despite not being able to be part of the prize pool this time, I managed to finish in the 58th out of 600 participants which I am proud of. More importantly, this CTF being heavily focused on Forensics have helped me to sharpen my skills in that area, something which I rarely meddle with. Don't particularly fancy level-unlocks CTFs but still a great experience overall. Kudos to the organising committee!
